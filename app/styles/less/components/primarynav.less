nav#nav-main
{
    // Default

    overflow: hidden;
    position: relative;
        top: 0;
        left: 0;
        z-index: 99;
    width: 100%;

    // Usually the state after scrolling from the top of the page.
    &.compact
    {
        @factor: 0.3;

        .icon-height(@factor);

        position: fixed;
            top: 0;

        .wrapper
        {
            background: #fff;
            border-bottom: 1px solid transparent;
        }

        // Menu items are closed.
        &.collapsed
        {
            .drop-shadow(0, 3px, 0, 0, 0, 0, 0, .04);

            .wrapper
            {
                border-bottom: 1px solid rgba(0, 0, 0, .15);
            }
        }
    }

    // When menu has "centered" behavior.
    &.centered
    {
        a#nav-icon
        {
            float: none;
            margin: 0 auto;
            // opacity: 0;
        }
    }

    .wrapper
    {
        overflow: hidden;
        border-bottom: 1px solid transparent;
    }

    // Importantly, this icon's visibility determines if the menu is collapsible.
    a#nav-icon
    {
        //.transition(all 600ms ease-out);

        color: @black_50;

        svg
        {
            fill: transparent;
            width: 100%;
            stroke: currentColor;
        }

        &:hover
        {
            color: #000;
        }

        .respond-until-including(@1_column_width,
        {
            width: 2.000em; // 32px
        });

        .respond-after(@1_column_width,
        {
            width: 2.125em; // 34px
        });
    }

    .nav-items
    {
        //float: left;
        //width: 100%;

        ul.nav-primary
        {
            //float: left;

            li
            {
                //float: left;
                //margin-left: @spacing_unit_root / 2;
            }

            li:first-child
            {
                //margin-left: 0;
            }

            li.gallery,
            li.list
            {
                a
                {
                    .transition(all 300ms ease-out);

                    display: block;

                    svg
                    {
                        fill: transparent;
                        stroke: currentColor;
                    }

                    span.text-label
                    {
                        display: none;
                    }

                    &:hover
                    {
                        //color: #000;
                    }
                }

                &.active
                {
                    a
                    {
                        //color: #000;
                        cursor: default;
                    }
                }
            }
        }

        ul.nav-sub
        {
            //float: right;

            li
            {
                //float: left;
                //margin-right: @spacing_unit_root;
                //width: auto;

                &:last-child
                {
                    //margin-right: 0;
                }

                a
                {
                    .transition(all 300ms ease-out);

                    //color: #808080;
                    display: block;
                    //font-family: @title_face;
                    //font-size: 1.125em;
                    //letter-spacing: 0.188em;
                    //text-decoration: none;
                    //text-transform: uppercase;

                    &:hover
                    {
                        //color: #000;
                    }
                }

                &.active
                {
                    a
                    {
                        //color: #000;
                        cursor: default;
                    }
                }
            }
        }
    }

    // Media Queries

    .respond-until-including(@multi_column_bp,
    {
        .collapsible-menu-a();
    });

    .respond-until-including(@1_column_width,
    {
        @factor: 0.5;

        .icon-height(@factor);
    });

    .respond-between(@1_column_width, @multi_column_bp,
    {
        @factor: 0.75;

        .icon-height(@factor);
    });

    .respond-after(@multi_column_bp,
    {
        @factor: 1;

        .item-heights(@factor);

        .horizontal-menu();
    });

    // Local Mixins

    .icon-height(@factor)
    {
        a#nav-icon
        {
            height: @header_height * @factor;

            svg
            {
                height: @header_height * @factor;
            }
        }
    }

    // This is ideal for situations where the primary menu is not collapsible
    // (i.e., all menu items are visible).
    .item-heights(@factor: 1)
    {
        .nav-items
        {
            ul.nav-primary
            {
                li
                {
                    height: @header_height * @factor;
                }

                li.gallery,
                li.list
                {
                    a
                    {
                        svg
                        {
                            height: @header_height * @factor;
                        }

                        span.text-label
                        {
                            height: @header_height * @factor;
                            line-height: @header_height * @factor;
                        }
                    }
                }
            }

            ul.nav-sub
            {
                li
                {
                    height: @header_height * @factor;
                    line-height: @header_height * @factor;

                    a
                    {
                        height: @header_height * @factor;
                        line-height: @header_height * @factor;
                    }
                }
            }
        }
    }
}

.horizontal-menu()
{
    a#nav-icon
    {
        display: none;
    }

    .nav-items
    {
        float: left;
        width: 100%;

        ul.nav-primary
        {
            float: left;

            li
            {
                float: left;
                margin-left: @spacing_unit_root / 2;
            }

            li:first-child
            {
                margin-left: 0;
            }

            li.gallery,
            li.list
            {
                a
                {
                    color: @black_50;
                    font-family: @title_face;
                    letter-spacing: 0.188em;
                    text-decoration: none;
                    text-transform: uppercase;

                    svg
                    {
                        float: left;
                        width: 2.000em; // 32px
                    }

                    span.text-label
                    {
                        display: none;
                    }

                    &:hover
                    {
                        color: #000;
                    }
                }

                &.active
                {
                    a
                    {
                        color: #000;
                        cursor: default;
                    }
                }
            }
        }

        ul.nav-sub
        {
            float: right;

            li
            {
                float: left;
                margin-right: @spacing_unit_root;
                width: auto;

                &:last-child
                {
                    margin-right: 0;
                }

                a
                {
                    color: @black_50;
                    font-family: @title_face;
                    font-size: 1.125em;
                    letter-spacing: 0.188em;
                    text-decoration: none;
                    text-transform: uppercase;

                    &:hover
                    {
                        color: #000;
                    }
                }

                &.active
                {
                    a
                    {
                        color: #000;
                        cursor: default;
                    }
                }
            }
        }
    }
}

.collapsible-menu-a()
{
    //font-size: 1.25rem;

    a#nav-icon
    {
        display: block;
        float: right;
        font-size: 1rem;
        margin-right: @spacing_unit_root / 2;
        position: relative;
            top: 0;
            left: 0;
            z-index: 100;
    }

    .nav-items
    {
        @item_height: 4.000rem;

        background: #1f1f1f;
        display: none;
        padding: @spacing_unit_root / 2 0;

        ul.nav-primary
        {
            position: relative;
                top: 0;
                left: 0;

            li
            {
                line-height: @item_height;
                margin: 0;

                &:first-child
                {
                    margin: 0;
                }
            }

            li.gallery,
            li.list
            {
                a
                {
                    color: @black_30;
                    text-decoration: none;

                    svg
                    {
                        display: none;

                        height: @item_height;
                        line-height: @item_height;
                        margin-left: @spacing_unit_root;
                        stroke: currentColor;
                    }

                    span.text-label
                    {
                        color: @hot_pink;
                        display: block;
                        font-family: @title_face;
                        font-size: @spacing_unit * 0.8;
                        font-weight: 100;
                        letter-spacing: 4px;
                        line-height: @item_height;
                        text-transform: uppercase;

                        .respond-until-including(@entry_image_width,
                        {
                            margin: 0 @spacing_unit_root / 2;
                        });

                        .respond-between(@entry_image_width, @entry_image_width + 100px,
                        {
                            margin: 0 @spacing_unit_root;
                        });

                        .respond-after(@entry_image_width + 100px,
                        {
                            margin: 0 auto;
                            width: @entry_image_width;
                        });
                    }

                    &:hover
                    {
                        color: #fff;
                        background: #343434;

                        svg
                        {
                            stroke: currentColor;
                        }

                        span.text-label
                        {
                            color: #fff;
                        }
                    }
                }

                &.active
                {
                    a
                    {
                        color: #fff;
                    }
                }
            }
        }

        ul.nav-sub
        {
            li
            {
                line-height: @item_height;

                a
                {
                    color: #fff;
                    font-family: @title_face;
                    font-size: @spacing_unit * 0.4;
                    letter-spacing: 0.188em;
                    line-height: @item_height;
                    text-decoration: none;
                    text-transform: uppercase;

                    .respond-until-including(@entry_image_width,
                    {
                        padding: 0 @spacing_unit_root / 2;
                    });

                    .respond-between(@entry_image_width, @entry_image_width + 100px,
                    {
                        padding: 0 @spacing_unit_root;
                    });

                    .respond-after(@entry_image_width + 100px,
                    {
                        margin: 0 auto;
                        width: @entry_image_width;
                    });

                    &:hover
                    {
                        color: @blue;
                    }
                }

                &.active
                {
                    a
                    {
                        color: #fff;
                    }
                }
            }
        }
    }
}

.primary-nav-arrow()
{
    nav#nav-main
    {
        .nav-items
        {
            ul.nav-primary
            {
                &::before
                {
                    .rotate(45deg);
                    .transition(all 200ms ease-out);

                    @box_length: ceil( @spacing_unit_root / 6 );

                    background: #1f1f1f;
                    content: '';
                    height: @box_length;
                    position: absolute;
                        top: -1 * (@spacing_unit_root / 2 + @box_length / 2);
                        right: @spacing_unit_root / 2 + 2.375em / 2 - @box_length / 2;
                        //z-index: -1;
                    width: @box_length;
                }

                &.animating::before
                {
                    top: 0;
                }
            }
        }
    }

    nav#nav-main.centered
    {
        .nav-items
        {
            ul.nav-primary
            {
                &::before
                {
                    @box_length: @spacing_unit_root / 4;

                    margin-right: -1 * @box_length / 2;
                    right: 50%;
                }
            }
        }
    }
}
